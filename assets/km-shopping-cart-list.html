<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">

<dom-module id="km-shopping-cart-list">
    <template>
        <style>
            .product-image{
                height: 80px;
                width: 80px;
            }
        </style>
        <div>
            <table style="width:100%">
                <tr>
                    <th>Product Name</th>
                    <th>Product Price</th>
                    <th>Remove</th>
                </tr>
                <template is="dom-repeat" items="{{cartItems}}">
                    <tr>
                        <td>
                            <paper-icon-button src="[[item.thumbnail]]"
                                               class="product-image"
                                               title="Product Image">
                            </paper-icon-button>{{item.name}}
                        </td>
                        <td>{{item.price_label}}</td>
                        <td>
                            <paper-icon-button class="action-icon-danger"
                                               icon="delete"
                                               title="Remove"
                                               on-click="_removeCartItem">
                            </paper-icon-button>
                        </td>
                    </tr>
                </template>

            </table>

        </div>
    </template>
    <script>
        (function () {
            Polymer({
                is: 'km-shopping-cart-list',
                properties: {},
                _removeCartItem:function(e){
                    var index = e.model.index;
                    this.splice("cartItems", index, 1);
                    var shoppingCartItems = localStorage.getItem('shoppingCartItems');
                    if(!shoppingCartItems){
                        return
                    }
                    var items = JSON.parse(shoppingCartItems);
                    items.splice(index, 1);
                    localStorage.setItem('shoppingCartItems', JSON.stringify(items));
                },
                ready: function(){
                    var shoppingCartItems = localStorage.getItem('shoppingCartItems');
                    var cartItems=[];
                    if(shoppingCartItems!==null){
                        cartItems = JSON.parse(shoppingCartItems)
                    }
                    console.log("Cart Items: ", cartItems);
                    this.cartItems = cartItems;
                }

            });
        })();
    </script>
</dom-module>